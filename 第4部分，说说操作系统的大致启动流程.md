
# 第四部分，说说操作系统的大致启动流程
在开始正式讲解Linux源码之前，我们先讲解一下操作系统启动的大致过程。对整个过程有一个宏观的感受，对后续的讲解会有很大的帮助。

> 实际上，我们去食堂吃饭也是，先慢慢看一圈，都有那些菜，然后再做选择，确保不会发生“我原本还可以选择更好的”情况。


# 第3章，操作系统启动的大致过程

我们按下开机键后，不一会儿，电脑就启动了。

其实也等同于，操作系统启动成功了，我们可以玩电脑上的游戏了，这些游戏都是运行在操作系统上的。

那么这个过程包含了那些**标志性动作**呢？

### 3.1操作系统最初的位置

我们知道，内存才是软件运行的地方。而磁盘是存储软件的地方。
首先，操作系统最初是存在于磁盘上的，我们需要通过一种机制将其加载到内存中去，让他开始运行。可这个时候，还没操作系统呢，谁能控制CPU完成这个任务？
这个时候，就需要一个非常小的程序来完成这个任务，这个程序叫做引导加载程序（Bootloader）。我们的操作系统可以分为两个部分：
- 引导加载程序（Bootloader）
- 操作系统内核（Kernel）
真正起作用，管理上层软件的是操作系统内核（Kernel）。
所以，操作系统的第一部分程序是引导加载程序（Bootloader），他的任务就是将操作系统内核加载到内存中去，让内核跑起来管理系统。

但是问题又来了，最初的引导加载程序（Bootloader）也是在磁盘上的啊。它又是如何被加载到内存中的呢？

通过计算机主板上的一块固定芯片，我们叫做BIOS芯片，他的作用就是加载引导加载程序（Bootloader）到内存中去。

好了，此时套娃就结束了，因为这个芯片就是厂商生产时做好了的，我们遵守他的规则，它就可以将我们自己写好的引导加载程序（Bootloader）加载到内存中去。从而完成整个链条的闭环。

注意，对于BIOS的实现，知识屏蔽就好了。我们研究的主题是操作系统，而不是这块芯片。


### 3.2 文件系统的诞生
我们知道，数据持久化保存在磁盘里面，所以磁盘上将会承载成千上万的文件，那么这些文件是如何被CPU访问的呢？也即，CPU是如何借助操作系统来访问他们的呢？敏锐的你也许会想到，磁盘上承载如此多的文件还能有条不紊地运行，这些文件也一定在以某种规则保存着。没错，确实有这套规则，这套规则就是我们的文件系统。

> 有些书上把文件系统看成操作系统的一部分，当然无可厚非，因为操作系统本身也就是一个抽象概念，他的作用就是管理硬件资源，提供服务。而文件系统，就是操作系统提供的服务之一，他的作用就是管理磁盘这个硬件。但是，我更喜欢将其分离，因为在操作系统内核未运行时，磁盘上就已经有了文件系统，这是为了便于内核运行起来后，直接与磁盘对接。所以从这个角度来看，将之分离，更加能够体现整个系统运行的各个环节。

>操作系统发现磁盘文件系统并与之对接的行为，我们叫做文件系统的挂载。

实际上，操作系统与磁盘的信息交互，都是通过对接文件系统来完成的。也即，操作系统把自己要“访问哪个文件”，“进行的操作”，“期待反馈回来的信息”等发送给文件系统后，文件系统帮助操作系统完成这一系列动作。

所以从本质上来说，计算机系统是操作系统+文件系统+各种硬件协同工作的产物。

